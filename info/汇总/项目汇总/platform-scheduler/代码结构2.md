# 调度系统项目结构

## 一、项目结构

```
platform-scheduler/
├── api/                                # API层
│   ├── controller/                     # 控制器
│   │   ├── job/                       # 任务相关控制器
│   │   │   ├── JobController.java     # 任务基础操作
│   │   │   ├── JobRegisterController.java  # 任务注册
│   │   │   └── JobExecuteController.java   # 任务执行
│   │   ├── monitor/                   # 监控相关控制器
│   │   │   ├── MetricsController.java # 指标监控
│   │   │   └── AlertController.java   # 告警管理
│   │   └── admin/                     # 管理控制器
│   │       └── SystemController.java  # 系统管理
│   └── model/                         # 数据模型
│       ├── request/                   # 请求对象
│       │   ├── job/
│       │   │   ├── JobCreateRequest.java
│       │   │   ├── JobUpdateRequest.java
│       │   │   ├── JobQueryRequest.java
│       │   │   ├── JobRegisterRequest.java
│       │   │   └── JobExecuteRequest.java
│       │   └── monitor/
│       │       ├── AlertRequest.java
│       │       └── MetricsRequest.java
│       └── vo/                       # 视图对象
│           ├── job/
│           │   ├── JobVO.java
│           │   ├── JobDetailVO.java
│           │   └── JobLogVO.java
│           └── monitor/
│               ├── MetricsVO.java
│               └── AlertVO.java
├── core/                            # 核心层
│   ├── executor/                    # 执行器
│   │   ├── JobExecutor.java        # 执行器接口
│   │   ├── DefaultJobExecutor.java # 默认实现
│   │   ├── HttpJobExecutor.java    # HTTP任务执行器
│   │   └── ShellJobExecutor.java   # Shell任务执行器
│   ├── scheduler/                   # 调度器
│   │   ├── JobScheduler.java       # 调度器接口
│   │   └── QuartzJobScheduler.java # Quartz实现
│   ├── handler/                    # 处理器
│   │   ├── VariableHandler.java    # 变量处理
│   │   └── ParamHandler.java       # 参数处理
│   └── manager/                    # 管理器
│       ├── JobManager.java         # 任务管理
│       └── ExecutionManager.java   # 执行管理
├── domain/                         # 领域层
│   ├── entity/                    # 实体
│   │   ├── job/
│   │   │   ├── JobDefinition.java
│   │   │   ├── JobExecution.java
│   │   │   └── JobLog.java
│   │   └── monitor/
│   │       ├── MetricsRecord.java
│   │       └── AlertRecord.java
│   ├── repository/                # 仓储接口
│   │   ├── JobRepository.java
│   │   └── ExecutionRepository.java
│   └── service/                   # 领域服务
│       ├── JobDomainService.java
│       └── ExecutionDomainService.java
├── infra/                         # 基础设施层
│   ├── config/                    # 配置
│   │   ├── QuartzConfig.java
│   │   ├── RedisConfig.java
│   │   └── ThreadPoolConfig.java
│   ├── persistence/               # 持久化
│   │   ├── mapper/
│   │   │   ├── JobMapper.java
│   │   │   └── ExecutionMapper.java
│   │   └── repository/
│   │       ├── JobRepositoryImpl.java
│   │       └── ExecutionRepositoryImpl.java
│   ├── lock/                      # 分布式锁
│   │   ├── DistributedLock.java
│   │   └── RedisLock.java
│   └── mq/                        # 消息队列
│       ├── producer/
│       │   └── JobProducer.java
│       └── consumer/
│           └── JobConsumer.java
├── extension/                     # 扩展功能
│   ├── variable/                  # 变量管理
│   │   ├── provider/
│   │   │   ├── TokenProvider.java
│   │   │   └── VersionProvider.java
│   │   ├── resolver/
│   │   │   └── VariableResolver.java
│   │   └── manager/
│   │       └── VariableManager.java
│   └── template/                  # 模板管理
│       ├── TaskTemplate.java
│       └── TemplateEngine.java
└── common/                        # 公共模块
    ├── constant/                  # 常量
    │   ├── JobConstant.java
    │   └── SystemConstant.java
    ├── utils/                     # 工具类
    │   ├── JsonUtils.java
    │   └── DateUtils.java
    └── exception/                 # 异常
        ├── JobException.java
        └── SystemException.java
```

## 二、文件变更说明

### 1. 新增文件
- api/controller/job/* - 任务相关控制器
- api/model/* - 请求/响应模型
- core/executor/* - 任务执行器实现
- extension/* - 扩展功能模块
- infra/lock/* - 分布式锁实现

### 2. 修改文件
- JobService.java - 增加任务注册方法
- TaskManager.java - 支持变量处理
- JobScheduler.java - 增加分布式支持
- JobRepository.java - 增加任务查询方法

### 3. 删除文件
- TestController.java
- CrawlerController.java
- DemoJob.java

## 三、核心模块说明

### 1. 任务管理模块
- 任务注册与配置
- 任务状态管理
- 执行策略配置
- 变量模板管理

### 2. 执行调度模块
- 任务调度
- 执行控制
- 状态追踪
- 失败重试

### 3. 分布式协调模块
- 分布式锁
- 任务分片
- 节点管理
- 状态同步

### 4. 监控告警模块
- 指标采集
- 状态监控
- 告警管理
- 报表统计

### 5. 扩展功能模块
- 变量管理
- 模板管理
- 批量任务
- 工作流